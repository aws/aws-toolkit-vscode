{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "description": "AWS System Manager Document Schema",
    "type": "object",
    "properties": {
        "schemaVersion": {
            "type": "string",
            "description": "Schema Version of Document. Command Document can use schemaVersion 1.2, 2.0, 2.2. Policy Document can use schemaVersion 2.0 and later. Automation Document must use schemaVersion 0.3."
        }
    },
    "required": ["schemaVersion"],
    "oneOf": [
        {
            "properties": {
                "schemaVersion": {
                    "enum": ["0.3", "1.2", "2.0", "2.2"]
                },
                "description": {
                    "type": "string",
                    "description": "Information you provide to describe the purpose of the document."
                },
                "assumeRole": {
                    "type": "string",
                    "description": "The ARN of the role that allows Automation to perform the actions on your behalf."
                },
                "parameters": {
                    "type": "object",
                    "description": "A structure that defines the parameters the document accepts.",
                    "properties": {},
                    "additionalProperties": {
                        "$ref": "parameterObject.json#/definitions/additionalProperties"
                    }
                },
                "runtimeConfig": {
                    "type": "object",
                    "description": "(Schema version 1.2 only) The configuration for the instance as applied by one or more Systems Manager plugins. Plugins are not guaranteed to run in sequence."
                },
                "files": {
                    "type": "object",
                    "description": "(Schema version 0.3 only) The script files (and their checksums) attached to the document and run during an automation execution. Applies only to documents that include the aws:executeScript action and for which attachments have been specified in one or more steps."
                },
                "outputs": {
                    "type": "array",
                    "description": "(Schema version 0.3 only) Data generated by the execution of this document that can be used in other processes. For example, if your document creates a new AMI, you might specify \"CreateImage.ImageId\" as the output value, and then use this output to create new instances in a subsequent automation execution. "
                },
                "mainSteps": {
                    "type": "array",
                    "description": "(Schema version 0.3, 2.0, and 2.2 only) An object that can include multiple steps (plugins). Plugins are defined within steps. Steps run in sequential order as listed in the document.",
                    "items": {
                        "type": "object",
                        "properties": {
                            "action": {
                                "type": "string",
                                "description": "The name of the action the step is to run."
                            },
                            "name": {
                                "type": "string",
                                "description": "An identifier that must be unique across all step names in the document."
                            },
                            "inputs": {
                                "type": "object",
                                "description": "The properties specific to the action."
                            },
                            "outputs": {
                                "type": "array",
                                "description": "Outputs for this step."
                            }
                        }
                    }
                }
            },
            "required": ["schemaVersion"],
            "additionalProperties": false,
            "allOf": [
                {
                    "if": {
                        "properties": { "schemaVersion": { "const": "1.2" } }
                    },
                    "then": {
                        "$ref": "command.json#/definitions/command12"
                    }
                },
                {
                    "if": {
                        "properties": { "schemaVersion": { "const": "2.2" } }
                    },
                    "then": {
                        "$ref": "command.json#/definitions/command22"
                    }
                },
                {
                    "if": {
                        "properties": { "schemaVersion": { "const": "0.3" } }
                    },
                    "then": {
                        "$ref": "automation.json#/definitions/automation03"
                    }
                }
            ]
        },
        {
            "properties": {
                "schemaVersion": {
                    "not": {
                        "enum": ["0.3", "1.2", "2.0", "2.2"]
                    }
                }
            },
            "required": ["schemaVersion"]
        },
        {
            "properties": {
                "schemaVersion": {
                    "not": {}
                }
            }
        }
    ]
}
